<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Form Colori Aree</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    fieldset {
      margin-bottom: 20px;
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 10px;
    }
    legend {
      font-weight: bold;
    }
    label {
      display: block;
      margin-top: 5px;
    }
    select, input[type="date"] {
      margin-bottom: 10px;
    }
    button {
      margin-right: 10px;
      padding: 10px 15px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <h1>AV Attach - Mese in Corso</h1>
  <form id="colorForm">

    <label>DATA: <input type="date" id="data" value="2025-05-14"></label>
    <label>PUNTO VENDITA:
      <select id="puntoVendita">
        <option value="FANO">FANO</option>
        <option value="MONSANO">MONSANO</option>
        <option value="OSIMO">OSIMO</option>
        <option value="MACERATA">MACERATA</option>
        <option value="CIVITANOVA">CIVITANOVA</option>
        <option value="PESARO">PESARO</option>
      </select>
    </label>

    <!-- Esempio di una sezione, le altre aree possono essere copiate -->
    <fieldset>
      <legend>GENERALE</legend>
      <label>ESTENDO <select name="GENERALE - ESTENDO" class="colorSelect">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>

      <label>QUSTODIA <select name="GENERALE - QUSTODIA" class="colorSelect">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
    </fieldset>

    <!-- Altre sezioni come CASSA, BIANCO, PED, TV, INFORMATICA, TELEFONIA vanno aggiunte qui come nell'esempio precedente -->

    <button type="button" onclick="sendEmail()">Invia via Email</button>
    <button type="button" onclick="sendTelegram()">Invia via Telegram</button>

  </form>

  <script>
    function generaMessaggio() {
      const data = document.getElementById('data').value;
      const puntoVendita = document.getElementById('puntoVendita').value;

      let messaggio = `📅 DATA: ${data || 'N.D.'}\n🏬 PUNTO VENDITA: ${puntoVendita || 'N.D.'}\n\n🔴🟠🟡 Report Attività Critiche:\n`;

      const selects = document.querySelectorAll('.colorSelect');
      const sezioni = {};

      selects.forEach(select => {
        const colore = select.value;
        const nomeCampo = select.name;

        if (["Giallo", "Arancio", "Rosso"].includes(colore)) {
          const [area, campo] = nomeCampo.split(" - ");
          if (!sezioni[area]) {
            sezioni[area] = [];
          }
          sezioni[area].push(`- ${campo}: ${colore}`);
        }
      });

      for (const area in sezioni) {
        messaggio += `\n📌 ${area}\n${sezioni[area].join('\n')}\n`;
      }

      return encodeURIComponent(messaggio.trim());
    }

    function sendEmail() {
      const body = generaMessaggio();
      window.location.href = `mailto:d.pavoni@dml-italia.com?subject=Report Aree Critiche&body=${body}`;
    }

    function sendTelegram() {
      const messaggio = generaMessaggio();
      window.open(`https://t.me/share/url?url=&text=${messaggio}`, "_blank");
    }
  </script>
</body>
</html>
