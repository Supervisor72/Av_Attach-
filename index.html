<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Form Colori Aree</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    fieldset {
      margin-bottom: 20px;
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 10px;
    }
    legend {
      font-weight: bold;
    }
    label {
      display: block;
      margin-top: 5px;
    }
    select, input[type="date"] {
      margin-bottom: 10px;
    }
    button {
      margin-right: 10px;
      padding: 10px 15px;
      font-size: 16px;
      cursor: pointer;
    }
    #totaleValue {
      padding: 5px 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      width: 60px;
      text-align: center;
    }
  </style>
</head>
<body>

  <h1>Qualita' Mese </h1>
  <form id="colorForm">

    <label>DATA: <input type="date" id="data" value="2025-05-14"></label>
    <label>PUNTO VENDITA:
      <select id="puntoVendita">
        <option value="FANO">FANO</option>
        <option value="MONSANO">MONSANO</option>
        <option value="OSIMO">OSIMO</option>
        <option value="MACERATA">MACERATA</option>
        <option value="CIVITANOVA">CIVITANOVA</option>
        <option value="PESARO">PESARO</option>
      </select>
    </label>
    <label>TOTALE: 
      <input type="text" id="totaleValue" placeholder="0%" style="width: 60px; text-align: center; padding: 5px;">
    </label>

    <fieldset>
      <legend>GENERALE</legend>
      <label>ESTENDO <select name="GENERALE - ESTENDO" class="colorSelect">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>QUSTODIA <select name="GENERALE - QUSTODIA" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
    </fieldset>

    <fieldset>
      <legend>CASSA</legend>
      <label>MYFANSAFE <select name="CASSA - MYFANSAFE" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>CARTE FAN <select name="CASSA - CARTE FAN" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
    </fieldset>

    <fieldset>
      <legend>BIANCO</legend>
      <label>EKOS <select name="BIANCO - EKOS" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>ASCIUGATRICI <select name="BIANCO - ASCIUGATRICI" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>SCHUCKO <select name="BIANCO - SCHUCKO" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>ANTICALCARE <select name="BIANCO - ANTICALCARE" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
    </fieldset>

    <fieldset>
      <legend>PED</legend>
      <label>SACCHETTI <select name="PED - SACCHETTI" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>ACC MICROONDE <select name="PED - ACC MICROONDE" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>CARAFFE <select name="PED - CARAFFE" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>CAFFE' <select name="PED - CAFFE'" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>TESTINE <select name="PED - TESTINE" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>ACC ROBOT <select name="PED - ACC ROBOT" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>ACC IMPASTATORI <select name="PED - ACC IMPASTATORI" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>PRODOTTI/CARAFFE <select name="PED - PRODOTTI/CARAFFE" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
    </fieldset>

    <fieldset>
      <legend>TV</legend>
      <label>ACCESSORI <select name="TV - ACCESSORI" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>SOUNDBAR <select name="TV - SOUNDBAR" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
    </fieldset>

    <fieldset>
      <legend>INFORMATICA</legend>
      <label>CARTUCCE <select name="INFORMATICA - CARTUCCE" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>SERVIZI <select name="INFORMATICA - SERVIZI" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>ANTIVIRUS <select name="INFORMATICA - ANTIVIRUS" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>OFFICE <select name="INFORMATICA - OFFICE" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>PACKPROMO <select name="INFORMATICA - PACKPROMO" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>MAC ESTENSIONI <select name="INFORMATICA - MAC ESTENSIONI" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>WATCH ESTENSIONI <select name="INFORMATICA - WATCH ESTENSIONI" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
    </fieldset>

    <fieldset>
      <legend>TELEFONIA</legend>
      <label>SERVIZI <select name="TELEFONIA - SERVIZI" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>FASTSKIN <select name="TELEFONIA - FASTSKIN" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>ACCESSORI <select name="TELEFONIA - ACCESSORI" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>CLEANVIR <select name="TELEFONIA - CLEANVIR" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>PACKPROMO <select name="TELEFONIA - PACKPROMO" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
      <label>ESTEN. IPHONE <select name="TELEFONIA - ESTEN. IPHONE" class="colorSelect" onchange="calcolaTotale()">
        <option value="Verde">Verde</option>
        <option value="Verdino">Verdino</option>
        <option value="Giallo">Giallo</option>
        <option value="Arancio">Arancio</option>
        <option value="Rosso">Rosso</option>
      </select></label>
    </fieldset>

    <button type="button" onclick="sendEmail()">Invia via Email</button>
    <button type="button" onclick="sendTelegram()">Invia via Telegram</button>

  </form>

  <script>
    // Rimuoviamo la funzione automatica che calcola il totale
    // document.addEventListener('DOMContentLoaded', calcolaTotale);

    function calcolaTotale() {
      // Questa funzione non viene più usata ma la manteniamo per riferimento futuro
    }

    function generaMessaggio() {
      const data = document.getElementById('data').value;
      const puntoVendita = document.getElementById('puntoVendita').value;
      const totale = document.getElementById('totaleValue').value;

      let messaggio = `📅 DATA: ${data || 'N.D.'}\n🏬 PUNTO VENDITA: ${puntoVendita || 'N.D.'}\n📊 TOTALE: ${totale || '0%'}\n\n🔴🟠🟡 Report Attach Critiche:\n`;

      const selects = document.querySelectorAll('.colorSelect');
      const sezioni = {};

      selects.forEach(select => {
        const colore = select.value;
        const nomeCampo = select.name;

        if (["Giallo", "Arancio", "Rosso"].includes(colore)) {
          const [area, campo] = nomeCampo.split(" - ");
          if (!sezioni[area]) {
            sezioni[area] = [];
          }
          sezioni[area].push(`- ${campo}: ${colore}`);
        }
      });

      for (const area in sezioni) {
        messaggio += `\n📌 ${area}\n${sezioni[area].join('\n')}\n`;
      }

      return encodeURIComponent(messaggio.trim());
    }

    function sendEmail() {
      const body = generaMessaggio();
      window.location.href = `mailto:d.pavoni@dml-italia.com?subject=Report Aree Critiche&body=${body}`;
    }

    function sendTelegram() {
      const messaggio = generaMessaggio();
      window.open(`https://t.me/share/url?url=&text=${messaggio}`, "_blank");
    }
  </script>
</body>
</html>
